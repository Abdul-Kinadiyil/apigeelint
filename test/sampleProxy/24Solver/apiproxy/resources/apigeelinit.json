[
    {
        "filePath": "/Users/davidwallen/Projects/bundle-linter/test/sampleProxy/24Solver/apiproxy",
        "errorCount": 0,
        "warningCount": 4,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "messages": [
            {
                "ruleId": "BN001",
                "severity": 2,
                "nodeType": "Bundle",
                "message": "Unexpected extension found with file \"/Users/davidwallen/Projects/bundle-linter/test/sampleProxy/24Solver/apiproxy/resources/jsc/jsCalculate.jsfoo\". Valid extensions: [\"js\",\"jsc\",\"json\"]"
            },
            {
                "ruleId": "PO013",
                "severity": 2,
                "source": "    var result = eval(candidate);",
                "line": 59,
                "column": 18,
                "nodeType": "Resource",
                "message": "(error): eval can be harmful."
            },
            {
                "ruleId": "PO013",
                "severity": 2,
                "source": "    var result = eval(candidate);",
                "line": 59,
                "column": 18,
                "nodeType": "Resource",
                "message": "(error): eval can be harmful."
            },
            {
                "ruleId": "BN006",
                "severity": 1,
                "nodeType": "Bundle",
                "message": "Bundle size (11) exceeds recommended limit of 4. Consider refactoring into two or more bundles. Large bundle take longer to deploy and are more difficult to debug and maintain."
            }
        ]
    },
    {
        "filePath": "/Users/davidwallen/Projects/bundle-linter/test/sampleProxy/24Solver/apiproxy/proxies/default.xml",
        "errorCount": 0,
        "warningCount": 12,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "messages": [
            {
                "ruleId": "CC003",
                "severity": 2,
                "source": "                <Condition>{wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar}</Condition>\n",
                "line": 35,
                "column": 17,
                "nodeType": "Condition",
                "message": "Overly long conditions on Stesp are difficult to debug and maintain. Condition is 412 characters."
            },
            {
                "ruleId": "ST001",
                "severity": 1,
                "source": "            <Step>\n            </Step>\n",
                "line": 37,
                "column": 13,
                "nodeType": "Step",
                "message": "Step name is empty."
            },
            {
                "ruleId": "PD002",
                "severity": 2,
                "source": "    <RouteRule name=\"noCond2\">\n        <TargetEndpoint>nc2</TargetEndpoint>\n    </RouteRule>\n",
                "line": 77,
                "column": 5,
                "nodeType": "RouteRule",
                "message": "Evaluation of RouteRules proceeds from top to bottom, the first match is executed. The additional RouteRules are therefore unreachable.More than 1 empty condition was found in the RouteRules for \"/Users/davidwallen/Projects/bundle-linter/test/sampleProxy/24Solver/apiproxy/proxies/default.xml\". Lines: 77 85 "
            },
            {
                "ruleId": "ST001",
                "severity": 2,
                "source": "<ProxyEndpoint name=\"default\">\n    <Description/>\n    <FaultRules>\n       <FaultRule name=\"ExtractVariablesFault\">\n            <Step>\n                <Name>ExtractVariablesFault</Name>\n            </Step>\n            <Condition>(fault.name = \"FailedToResolveAPIKey\")</Condition>\n        </FaultRule>\n    </FaultRules>\n    <DefaultFaultRule name=\"default-fault\">\n        <Step>\n            <Name>Default-message</Name>\n        </Step>\n    </DefaultFaultRule>\n    <PreFlow name=\"PreFlow\">\n        <Request>\n            <Step>\n                <FaultRules/>\n                <Name>JSONThreatProtection</Name>\n                <Condition>request.verb=\"POST\"</Condition>\n            </Step>\n            <Step>\n                <Name>AssignMessage.CopyRequest</Name>\n            </Step>\n            <Step>\n                <FaultRules/>\n                <Name>ExtractParamVariables</Name>\n                <Condition>request.verb=\"GET\"</Condition>\n            </Step>\n            <Step>\n                <FaultRules/>\n                <Name>ExtractPayloadVariables</Name>\n                <Condition>{wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar}</Condition>\n            </Step>\n            <Step>\n            </Step>\n            <Step>\n                <Name>publishPurchaseDetails</Name>Ï\n            </Step>\n            <Step>\n                <Name>publishPurchaseDetails</Name>Ï\n            </Step>\n        </Request>\n        <Response/>\n    </PreFlow>\n    <Flows>\n        <Flow name=\"flow1\">\n            <Condition/>\n        </Flow>\n        <Flow name=\"flow2\">\n            <Condition/>\n        </Flow>\n    </Flows>\n    <PostFlow name=\"PostFlow\">\n        <Request/>\n        <Response>\n            <!-- <Step>\n                <FaultRules/>\n                <Name>jsCalculate</Name>\n            </Step> -->\n        </Response>\n    </PostFlow>\n    <RouteRule name=\"foo\">\n        <Condition>(proxy.pathsuffix MatchesPath \"/{version}/profile/{profile.id}/pin**\")</Condition>\n        <TargetEndpoint>foo</TargetEndpoint>\n    </RouteRule>\n    <RouteRule name=\"bar\">\n        <Condition>(proxy.pathsuffix MatchesPath \"/{version}/profile/{profile.id}/preferredversion\")</Condition>\n        <TargetEndpoint>bar</TargetEndpoint>\n    </RouteRule>\n    <RouteRule name=\"noCond1\">\n        <Condition></Condition>\n        <TargetEndpoint>nc1</TargetEndpoint>\n    </RouteRule>\n    <RouteRule name=\"noCond2\">\n        <TargetEndpoint>nc2</TargetEndpoint>\n    </RouteRule>\n    <HTTPProxyConnection>\n        <BasePath>/24solver</BasePath>\n        <VirtualHost>default</VirtualHost>\n        <VirtualHost>secure</VirtualHost>\n    </HTTPProxyConnection>\n    <RouteRule name=\"noroute\" />\n</ProxyEndpoint>\n\nundefined\n",
                "line": 2,
                "column": 1,
                "nodeType": "Endpoint",
                "message": "Endpoint /Users/davidwallen/Projects/bundle-linter/test/sampleProxy/24Solver/apiproxy/proxies/default.xml:#document: has too many uncondtional flows (2).  Only one will be executed."
            },
            {
                "ruleId": "BN004",
                "severity": 1,
                "source": "            <Step>\n                <FaultRules/>\n                <Name>ExtractPayloadVariables</Name>\n                <Condition>{wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar}</Condition>\n            </Step>\n",
                "line": 32,
                "column": 13,
                "nodeType": "Bundle",
                "message": "Variable {wackyvar} was used in step condition, but not previously defined."
            },
            {
                "ruleId": "BN004",
                "severity": 1,
                "source": "            <Step>\n                <FaultRules/>\n                <Name>ExtractPayloadVariables</Name>\n                <Condition>{wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar}</Condition>\n            </Step>\n",
                "line": 32,
                "column": 13,
                "nodeType": "Bundle",
                "message": "Variable {foovar} was used in step condition, but not previously defined."
            },
            {
                "ruleId": "BN004",
                "severity": 1,
                "source": "            <Step>\n                <FaultRules/>\n                <Name>ExtractPayloadVariables</Name>\n                <Condition>{wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar}</Condition>\n            </Step>\n",
                "line": 32,
                "column": 13,
                "nodeType": "Bundle",
                "message": "Variable {wackyvar} was used in step condition, but not previously defined."
            },
            {
                "ruleId": "BN004",
                "severity": 1,
                "source": "            <Step>\n                <FaultRules/>\n                <Name>ExtractPayloadVariables</Name>\n                <Condition>{wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar}</Condition>\n            </Step>\n",
                "line": 32,
                "column": 13,
                "nodeType": "Bundle",
                "message": "Variable {foovar} was used in step condition, but not previously defined."
            },
            {
                "ruleId": "BN004",
                "severity": 1,
                "source": "            <Step>\n                <FaultRules/>\n                <Name>ExtractPayloadVariables</Name>\n                <Condition>{wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar}</Condition>\n            </Step>\n",
                "line": 32,
                "column": 13,
                "nodeType": "Bundle",
                "message": "Variable {wackyvar} was used in step condition, but not previously defined."
            },
            {
                "ruleId": "BN004",
                "severity": 1,
                "source": "            <Step>\n                <FaultRules/>\n                <Name>ExtractPayloadVariables</Name>\n                <Condition>{wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar}</Condition>\n            </Step>\n",
                "line": 32,
                "column": 13,
                "nodeType": "Bundle",
                "message": "Variable {foovar} was used in step condition, but not previously defined."
            },
            {
                "ruleId": "BN004",
                "severity": 1,
                "source": "            <Step>\n                <FaultRules/>\n                <Name>ExtractPayloadVariables</Name>\n                <Condition>{wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar}</Condition>\n            </Step>\n",
                "line": 32,
                "column": 13,
                "nodeType": "Bundle",
                "message": "Variable {wackyvar} was used in step condition, but not previously defined."
            },
            {
                "ruleId": "BN004",
                "severity": 1,
                "source": "            <Step>\n                <FaultRules/>\n                <Name>ExtractPayloadVariables</Name>\n                <Condition>{wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar}</Condition>\n            </Step>\n",
                "line": 32,
                "column": 13,
                "nodeType": "Bundle",
                "message": "Variable {foovar} was used in step condition, but not previously defined."
            }
        ],
        "source": "<ProxyEndpoint name=\"default\">\n    <Description/>\n    <FaultRules>\n       <FaultRule name=\"ExtractVariablesFault\">\n            <Step>\n                <Name>ExtractVariablesFault</Name>\n            </Step>\n            <Condition>(fault.name = \"FailedToResolveAPIKey\")</Condition>\n        </FaultRule>\n    </FaultRules>\n    <DefaultFaultRule name=\"default-fault\">\n        <Step>\n            <Name>Default-message</Name>\n        </Step>\n    </DefaultFaultRule>\n    <PreFlow name=\"PreFlow\">\n        <Request>\n            <Step>\n                <FaultRules/>\n                <Name>JSONThreatProtection</Name>\n                <Condition>request.verb=\"POST\"</Condition>\n            </Step>\n            <Step>\n                <Name>AssignMessage.CopyRequest</Name>\n            </Step>\n            <Step>\n                <FaultRules/>\n                <Name>ExtractParamVariables</Name>\n                <Condition>request.verb=\"GET\"</Condition>\n            </Step>\n            <Step>\n                <FaultRules/>\n                <Name>ExtractPayloadVariables</Name>\n                <Condition>{wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar} or {wackyvar.foo} and request.verb=\"POST\" and request.header.contenttype=\"application/json\" or {foovar}</Condition>\n            </Step>\n            <Step>\n            </Step>\n            <Step>\n                <Name>publishPurchaseDetails</Name>Ï\n            </Step>\n            <Step>\n                <Name>publishPurchaseDetails</Name>Ï\n            </Step>\n        </Request>\n        <Response/>\n    </PreFlow>\n    <Flows>\n        <Flow name=\"flow1\">\n            <Condition/>\n        </Flow>\n        <Flow name=\"flow2\">\n            <Condition/>\n        </Flow>\n    </Flows>\n    <PostFlow name=\"PostFlow\">\n        <Request/>\n        <Response>\n            <!-- <Step>\n                <FaultRules/>\n                <Name>jsCalculate</Name>\n            </Step> -->\n        </Response>\n    </PostFlow>\n    <RouteRule name=\"foo\">\n        <Condition>(proxy.pathsuffix MatchesPath \"/{version}/profile/{profile.id}/pin**\")</Condition>\n        <TargetEndpoint>foo</TargetEndpoint>\n    </RouteRule>\n    <RouteRule name=\"bar\">\n        <Condition>(proxy.pathsuffix MatchesPath \"/{version}/profile/{profile.id}/preferredversion\")</Condition>\n        <TargetEndpoint>bar</TargetEndpoint>\n    </RouteRule>\n    <RouteRule name=\"noCond1\">\n        <Condition></Condition>\n        <TargetEndpoint>nc1</TargetEndpoint>\n    </RouteRule>\n    <RouteRule name=\"noCond2\">\n        <TargetEndpoint>nc2</TargetEndpoint>\n    </RouteRule>\n    <HTTPProxyConnection>\n        <BasePath>/24solver</BasePath>\n        <VirtualHost>default</VirtualHost>\n        <VirtualHost>secure</VirtualHost>\n    </HTTPProxyConnection>\n    <RouteRule name=\"noroute\" />\n</ProxyEndpoint>\n\nundefined\n"
    },
    {
        "filePath": "/Users/davidwallen/Projects/bundle-linter/test/sampleProxy/24Solver/apiproxy/policies/AssignMessagebadDisplayName.xml",
        "errorCount": 0,
        "warningCount": 1,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "messages": [
            {
                "ruleId": "PO008",
                "severity": 2,
                "source": "",
                "nodeType": "Policy",
                "message": "Filename \"AssignMessage.CopyRequest\" does not match policy display name \"\". To avoid confusion when working online and offline use the same name for files and display name in policies (excluding .xml extension)."
            }
        ]
    },
    {
        "filePath": "/Users/davidwallen/Projects/bundle-linter/test/sampleProxy/24Solver/apiproxy/policies/ExtractParamVariables.xml",
        "errorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "messages": []
    },
    {
        "filePath": "/Users/davidwallen/Projects/bundle-linter/test/sampleProxy/24Solver/apiproxy/policies/ExtractPayloadVariables.xml",
        "errorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "messages": []
    },
    {
        "filePath": "/Users/davidwallen/Projects/bundle-linter/test/sampleProxy/24Solver/apiproxy/policies/ExtractVariables.xml",
        "errorCount": 0,
        "warningCount": 1,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "messages": [
            {
                "ruleId": "BN005",
                "severity": 1,
                "source": "",
                "nodeType": "Policy",
                "message": "ExtractVariables is not attached to a Step in the bundle.  Remove unused policies."
            }
        ]
    },
    {
        "filePath": "/Users/davidwallen/Projects/bundle-linter/test/sampleProxy/24Solver/apiproxy/policies/ExtractVariablesFault.xml",
        "errorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "messages": []
    },
    {
        "filePath": "/Users/davidwallen/Projects/bundle-linter/test/sampleProxy/24Solver/apiproxy/policies/ExtractVariables_1.xml",
        "errorCount": 0,
        "warningCount": 2,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "messages": [
            {
                "ruleId": "PO008",
                "severity": 2,
                "source": "",
                "nodeType": "Policy",
                "message": "Filename \"MyExtractVariables\" does not match policy display name \"ExtractParamVariables\". To avoid confusion when working online and offline use the same name for files and display name in policies (excluding .xml extension)."
            },
            {
                "ruleId": "BN005",
                "severity": 1,
                "source": "",
                "nodeType": "Policy",
                "message": "MyExtractVariables is not attached to a Step in the bundle.  Remove unused policies."
            }
        ]
    },
    {
        "filePath": "/Users/davidwallen/Projects/bundle-linter/test/sampleProxy/24Solver/apiproxy/policies/ExtractVariables_unattached.xml",
        "errorCount": 0,
        "warningCount": 2,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "messages": [
            {
                "ruleId": "PO008",
                "severity": 2,
                "source": "",
                "nodeType": "Policy",
                "message": "Filename \"SomeExtractVariablesUnattached\" does not match policy display name \"ExtractParamVariables\". To avoid confusion when working online and offline use the same name for files and display name in policies (excluding .xml extension)."
            },
            {
                "ruleId": "BN005",
                "severity": 1,
                "source": "",
                "nodeType": "Policy",
                "message": "SomeExtractVariablesUnattached is not attached to a Step in the bundle.  Remove unused policies."
            }
        ]
    },
    {
        "filePath": "/Users/davidwallen/Projects/bundle-linter/test/sampleProxy/24Solver/apiproxy/policies/JSONThreatProtection.xml",
        "errorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "messages": []
    },
    {
        "filePath": "/Users/davidwallen/Projects/bundle-linter/test/sampleProxy/24Solver/apiproxy/policies/badServiceCallout.xml",
        "errorCount": 0,
        "warningCount": 3,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "messages": [
            {
                "ruleId": "PO008",
                "severity": 2,
                "source": "",
                "nodeType": "Policy",
                "message": "Filename \"service-callout\" does not match policy display name \"service-callout\". To avoid confusion when working online and offline use the same name for files and display name in policies (excluding .xml extension)."
            },
            {
                "ruleId": "BN005",
                "severity": 1,
                "source": "",
                "nodeType": "Policy",
                "message": "service-callout is not attached to a Step in the bundle.  Remove unused policies."
            },
            {
                "ruleId": "PO020",
                "severity": 2,
                "source": "",
                "nodeType": "Policy",
                "message": "Policy has a Response variable named \"response\", this may lead to unexpected side effects. Rename the Resopnse variable."
            }
        ]
    },
    {
        "filePath": "/Users/davidwallen/Projects/bundle-linter/test/sampleProxy/24Solver/apiproxy/policies/jsCalculate.xml",
        "errorCount": 0,
        "warningCount": 1,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "messages": [
            {
                "ruleId": "BN005",
                "severity": 1,
                "source": "",
                "nodeType": "Policy",
                "message": "jsCalculate is not attached to a Step in the bundle.  Remove unused policies."
            }
        ]
    },
    {
        "filePath": "/Users/davidwallen/Projects/bundle-linter/test/sampleProxy/24Solver/apiproxy/policies/statColl.xml",
        "errorCount": 0,
        "warningCount": 2,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "messages": [
            {
                "ruleId": "PO008",
                "severity": 2,
                "source": "",
                "nodeType": "Policy",
                "message": "Filename \"publishPurchaseDetails\" does not match policy display name \"\". To avoid confusion when working online and offline use the same name for files and display name in policies (excluding .xml extension)."
            },
            {
                "ruleId": "PD002",
                "severity": 1,
                "source": "",
                "nodeType": "Policy",
                "message": "publishPurchaseDetails is attached to multiple steps, but all the steps don't have a condition. This may result in unexpected behaviour."
            }
        ]
    },
    {
        "filePath": "apigeelinit.json",
        "errorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "messages": []
    },
    {
        "filePath": "jsCalculate.js",
        "errorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "messages": []
    },
    {
        "filePath": "jsCalculate.jsfoo",
        "errorCount": 0,
        "warningCount": 0,
        "fixableErrorCount": 0,
        "fixableWarningCount": 0,
        "messages": []
    }
]